{% extends "admin/base_site.html" %}
{% load i18n static %}

{% block extrastyle %}{{ block.super }}
<style>
    .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 20px;
        margin-bottom: 30px;
    }
    
    .stat-card {
        background: white;
        border-radius: 12px;
        padding: 20px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        text-align: center;
        transition: transform 0.2s ease;
    }
    
    .stat-card:hover {
        transform: translateY(-2px);
    }
    
    .stat-number {
        font-size: 2.5em;
        font-weight: bold;
        color: #007bff;
        margin-bottom: 8px;
    }
    
    .stat-label {
        color: #6c757d;
        font-size: 14px;
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }
    
    .stat-card.success .stat-number { color: #28a745; }
    .stat-card.warning .stat-number { color: #ffc107; }
    .stat-card.info .stat-number { color: #17a2b8; }
    
    .charts-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 20px;
        margin-bottom: 30px;
    }
    
    .chart-card {
        background: white;
        border-radius: 12px;
        padding: 20px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    
    .chart-title {
        font-size: 18px;
        font-weight: 600;
        color: #495057;
        margin-bottom: 15px;
        border-bottom: 2px solid #e9ecef;
        padding-bottom: 10px;
    }
    
    .chart-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 8px 0;
        border-bottom: 1px solid #f8f9fa;
    }
    
    .chart-item:last-child {
        border-bottom: none;
    }
    
    .chart-label {
        color: #495057;
        font-weight: 500;
    }
    
    .chart-value {
        background: #007bff;
        color: white;
        padding: 4px 8px;
        border-radius: 12px;
        font-size: 12px;
        font-weight: bold;
    }
    
    .latest-products {
        background: white;
        border-radius: 12px;
        padding: 20px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    
    .product-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 12px 0;
        border-bottom: 1px solid #f8f9fa;
    }
    
    .product-item:last-child {
        border-bottom: none;
    }
    
    .product-info {
        flex: 1;
    }
    
    .product-title {
        font-weight: 600;
        color: #495057;
        margin-bottom: 4px;
    }
    
    .product-meta {
        font-size: 12px;
        color: #6c757d;
    }
    
    .product-badge {
        padding: 4px 8px;
        border-radius: 12px;
        font-size: 11px;
        font-weight: bold;
        text-transform: uppercase;
    }
    
    .badge-wrf { background: #3B82F6; color: white; }
    .badge-fwi { background: #EF4444; color: white; }
    .badge-wind { background: #10B981; color: white; }
    .badge-air { background: #8B5CF6; color: white; }
    .badge-radar { background: #F59E0B; color: white; }
    .badge-satellite { background: #06B6D4; color: white; }
    
    @media (max-width: 768px) {
        .charts-grid {
            grid-template-columns: 1fr;
        }
        
        .stats-grid {
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        }
    }
</style>
{% endblock %}

{% block coltype %}colMS{% endblock %}

{% block bodyclass %}{{ block.super }} dashboard{% endblock %}

{% block breadcrumbs %}
<div class="breadcrumbs">
<a href="{% url 'admin:index' %}">üè† Inicio</a>
&rsaquo; Dashboard
</div>
{% endblock %}

{% block content %}
<div id="content-main">
    <!-- Estad√≠sticas principales -->
    <div class="stats-grid">
        <div class="stat-card">
            <div class="stat-number">{{ total_products }}</div>
            <div class="stat-label">Total Productos</div>
        </div>
        <div class="stat-card success">
            <div class="stat-number">{{ available_products }}</div>
            <div class="stat-label">Disponibles</div>
        </div>
        <div class="stat-card warning">
            <div class="stat-number">{{ recent_products }}</div>
            <div class="stat-label">√öltimas 24h</div>
        </div>
        <div class="stat-card info">
            <div class="stat-number">{{ total_types }}</div>
            <div class="stat-label">Tipos Activos</div>
        </div>
    </div>

    <!-- Gr√°ficos y estad√≠sticas -->
    <div class="charts-grid">
        <!-- Productos por tipo -->
        <div class="chart-card">
            <div class="chart-title">üìä Productos por Tipo</div>
            {% for type in products_by_type %}
            <div class="chart-item">
                <span class="chart-label">{{ type.name }}</span>
                <span class="chart-value">{{ type.product_count }}</span>
            </div>
            {% endfor %}
        </div>

        <!-- Formatos de archivo -->
        <div class="chart-card">
            <div class="chart-title">üìÅ Formatos de Archivo</div>
            {% for format in format_stats %}
            <div class="chart-item">
                <span class="chart-label">{{ format.file_format|upper }}</span>
                <span class="chart-value">{{ format.count }}</span>
            </div>
            {% endfor %}
        </div>
    </div>

    <!-- Productos m√°s recientes -->
    <div class="latest-products">
        <div class="chart-title">‚≠ê Productos M√°s Recientes</div>
        {% for product in latest_products %}
        <div class="product-item">
            <div class="product-info">
                <div class="product-title">{{ product.title }}</div>
                <div class="product-meta">
                    {{ product.generated_at|date:"d/m/Y H:i" }} ‚Ä¢ 
                    {{ product.age_hours|floatformat:1 }}h ‚Ä¢ 
                    {{ product.file_format|upper }}
                </div>
            </div>
            <span class="product-badge badge-{{ product.product_type.code|lower }}">
                {{ product.product_type.code }}
            </span>
        </div>
        {% endfor %}
    </div>

    <!-- Acciones r√°pidas -->
    <div style="margin-top: 30px;">
        <h2>üöÄ Acciones R√°pidas</h2>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-top: 15px;">
            <a href="{% url 'admin:products_weatherproduct_changelist' %}" class="button" style="text-decoration: none; text-align: center;">
                üìã Ver Todos los Productos
            </a>
            <a href="{% url 'admin:products_producttype_changelist' %}" class="button" style="text-decoration: none; text-align: center;">
                üè∑Ô∏è Gestionar Tipos
            </a>
            <a href="{% url 'admin:products_weatherproduct_add' %}" class="button" style="text-decoration: none; text-align: center;">
                ‚ûï Agregar Producto
            </a>
            <a href="/api/docs/" class="button" style="text-decoration: none; text-align: center;">
                üìö Documentaci√≥n API
            </a>
        </div>
    </div>
</div>
{% endblock %} 